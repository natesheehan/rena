2023-10-12 16:44:07.978  INFO 8132 --- [main] u.a.e.ena.EnaFileDownloaderApplication   : Starting EnaFileDownloaderApplication using Java 20.0.2 on 5CG1275NG3 with PID 8132 (C:\Users\ns651\OneDrive - University of Exeter\Desktop\rena\ena-file-downloader\ena-file-downloader.jar started by ns651 in C:\Users\ns651\OneDrive - University of Exeter\Desktop\rena)
2023-10-12 16:44:07.981 DEBUG 8132 --- [main] u.a.e.ena.EnaFileDownloaderApplication   : Running with Spring Boot v2.4.5, Spring v5.3.6
2023-10-12 16:44:07.981  INFO 8132 --- [main] u.a.e.ena.EnaFileDownloaderApplication   : No active profile set, falling back to default profiles: default
2023-10-12 16:44:09.072  INFO 8132 --- [main] u.a.e.ena.EnaFileDownloaderApplication   : Started EnaFileDownloaderApplication in 1.679 seconds (JVM running for 2.606)
2023-10-12 16:44:09.082  INFO 8132 --- [main] console                                  : Starting download for format:READS_FASTQ at download location:C:/Users/ns651/OneDrive,protocol:FTP, asperaLoc:null, emailId:NULL, data hub:null
2023-10-12 16:44:09.091  INFO 8132 --- [main] console                                  : Total 1 sample_accession READS_FASTQ records found
2023-10-12 16:44:21.301  INFO 8132 --- [main] u.a.e.e.b.service.EnaPortalService       : portalAPIEndpoint: https://www.ebi.ac.uk/ena/portal/api/search?result=read_run&includeAccessionType=sample&fields=sample_accession,fastq_bytes,fastq_md5,fastq_ftp&format=json&limit=0&client=ena_file_downloader
2023-10-12 16:44:21.304 DEBUG 8132 --- [main] u.a.e.e.b.service.EnaPortalService       : url:https://www.ebi.ac.uk/ena/portal/api/search?result=read_run&includeAccessionType=sample&fields=sample_accession,fastq_bytes,fastq_md5,fastq_ftp&format=json&limit=0&client=ena_file_downloader, body:includeAccessions=SAMEA10254937
2023-10-12 16:44:21.906  INFO 8132 --- [main] console                                  : Downloading 2 files in total
2023-10-12 16:44:21.982 DEBUG 8132 --- [pool-2-thread-1] u.a.e.e.b.service.FileDownloaderService  : Starting 2 files starting with ftp.sra.ebi.ac.uk/vol1/fastq/ERR691/006/ERR6912696/ERR6912696_1.fastq.gz
2023-10-12 16:44:21.983  INFO 8132 --- [pool-2-thread-1] u.a.e.e.b.service.FileDownloaderService  : FileURL: ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR691/006/ERR6912696/ERR6912696_1.fastq.gz
2023-10-12 16:44:21.985 DEBUG 8132 --- [pool-2-thread-1] u.a.e.e.b.service.FileDownloaderService  : Downloading ERR6912696_1.fastq.gz, parentId:SAMEA10254937
2023-10-12 16:49:22.035 ERROR 8132 --- [pool-2-thread-1] u.a.e.e.b.service.FileDownloaderClient   : C:\Users\ns651\OneDrive\reads_fastq\SAMEA10254937\ERR6912696\ERR6912696_1.fastq.gz failed to download

java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:278)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:304)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:345)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:794)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:1025)
	at java.base/java.io.BufferedInputStream.fill(BufferedInputStream.java:258)
	at java.base/java.io.BufferedInputStream.implRead(BufferedInputStream.java:292)
	at java.base/java.io.BufferedInputStream.read(BufferedInputStream.java:279)
	at java.base/sun.net.ftp.impl.FtpClient.readServerResponse(FtpClient.java:434)
	at java.base/sun.net.ftp.impl.FtpClient.readReply(FtpClient.java:511)
	at java.base/sun.net.ftp.impl.FtpClient.issueCommand(FtpClient.java:553)
	at java.base/sun.net.ftp.impl.FtpClient.issueCommandCheck(FtpClient.java:564)
	at java.base/sun.net.ftp.impl.FtpClient.changeDirectory(FtpClient.java:1243)
	at java.base/sun.net.www.protocol.ftp.FtpURLConnection.cd(FtpURLConnection.java:404)
	at java.base/sun.net.www.protocol.ftp.FtpURLConnection.getInputStream(FtpURLConnection.java:454)
	at uk.ac.ebi.ena.backend.service.FileDownloaderClient.downloadFTPUrlConnection(FileDownloaderClient.java:178)
	at uk.ac.ebi.ena.backend.service.FileDownloaderService.lambda$startDownload$0(FileDownloaderService.java:228)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1623)

2023-10-12 16:49:22.035 DEBUG 8132 --- [pool-2-thread-1] u.a.e.e.b.service.FileDownloaderService  : Completed download ERR6912696_1.fastq.gz, parentId:SAMEA10254937, bytesCopied:0
2023-10-12 16:49:22.035  WARN 8132 --- [pool-2-thread-1] u.a.e.e.b.service.FileDownloaderService  : Unsuccessful Validation for remoteFile:ftp.sra.ebi.ac.uk/vol1/fastq/ERR691/006/ERR6912696/ERR6912696_1.fastq.gz. Bytes downloaded does not match with given bytes
2023-10-12 16:49:22.035 ERROR 8132 --- [pool-2-thread-1] u.a.e.e.b.service.FileDownloaderService  : Failed to download file:ERR6912696_1.fastq.gz, experimentId:SAMEA10254937
2023-10-12 16:49:22.036  INFO 8132 --- [pool-2-thread-1] u.a.e.e.b.service.FileDownloaderService  : FileURL: ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR691/006/ERR6912696/ERR6912696_2.fastq.gz
2023-10-12 16:49:22.036 DEBUG 8132 --- [pool-2-thread-1] u.a.e.e.b.service.FileDownloaderService  : Downloading ERR6912696_2.fastq.gz, parentId:SAMEA10254937
2023-10-12 16:54:22.084 ERROR 8132 --- [pool-2-thread-1] u.a.e.e.b.service.FileDownloaderClient   : C:\Users\ns651\OneDrive\reads_fastq\SAMEA10254937\ERR6912696\ERR6912696_2.fastq.gz failed to download

java.net.SocketTimeoutException: Read timed out
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:278)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:304)
	at java.base/sun.nio.ch.NioSocketImpl.read(NioSocketImpl.java:345)
	at java.base/sun.nio.ch.NioSocketImpl$1.read(NioSocketImpl.java:794)
	at java.base/java.net.Socket$SocketInputStream.read(Socket.java:1025)
	at java.base/java.io.BufferedInputStream.fill(BufferedInputStream.java:258)
	at java.base/java.io.BufferedInputStream.implRead(BufferedInputStream.java:292)
	at java.base/java.io.BufferedInputStream.read(BufferedInputStream.java:279)
	at java.base/sun.net.ftp.impl.FtpClient.readServerResponse(FtpClient.java:434)
	at java.base/sun.net.ftp.impl.FtpClient.readReply(FtpClient.java:511)
	at java.base/sun.net.ftp.impl.FtpClient.issueCommand(FtpClient.java:553)
	at java.base/sun.net.ftp.impl.FtpClient.issueCommandCheck(FtpClient.java:564)
	at java.base/sun.net.ftp.impl.FtpClient.changeDirectory(FtpClient.java:1243)
	at java.base/sun.net.www.protocol.ftp.FtpURLConnection.cd(FtpURLConnection.java:404)
	at java.base/sun.net.www.protocol.ftp.FtpURLConnection.getInputStream(FtpURLConnection.java:454)
	at uk.ac.ebi.ena.backend.service.FileDownloaderClient.downloadFTPUrlConnection(FileDownloaderClient.java:178)
	at uk.ac.ebi.ena.backend.service.FileDownloaderService.lambda$startDownload$0(FileDownloaderService.java:228)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1623)

2023-10-12 16:54:22.084 DEBUG 8132 --- [pool-2-thread-1] u.a.e.e.b.service.FileDownloaderService  : Completed download ERR6912696_2.fastq.gz, parentId:SAMEA10254937, bytesCopied:0
2023-10-12 16:54:22.084  WARN 8132 --- [pool-2-thread-1] u.a.e.e.b.service.FileDownloaderService  : Unsuccessful Validation for remoteFile:ftp.sra.ebi.ac.uk/vol1/fastq/ERR691/006/ERR6912696/ERR6912696_2.fastq.gz. Bytes downloaded does not match with given bytes
2023-10-12 16:54:22.084 ERROR 8132 --- [pool-2-thread-1] u.a.e.e.b.service.FileDownloaderService  : Failed to download file:ERR6912696_2.fastq.gz, experimentId:SAMEA10254937
2023-10-12 16:54:22.086  WARN 8132 --- [main] u.a.e.e.b.service.BackendServiceImpl     : Number of files:0 successfully downloaded for accessionField:sample_accession, format:READS_FASTQ
2023-10-12 16:54:22.086  WARN 8132 --- [main] u.a.e.e.b.service.BackendServiceImpl     : Number of files:2 failed downloaded for accessionField:sample_accession, format:READS_FASTQ
2023-10-12 16:54:22.091 DEBUG 8132 --- [pool-3-thread-1] u.a.e.e.b.service.FileDownloaderService  : Starting 2 files starting with ftp.sra.ebi.ac.uk/vol1/fastq/ERR691/006/ERR6912696/ERR6912696_1.fastq.gz
2023-10-12 16:54:22.091  INFO 8132 --- [pool-3-thread-1] u.a.e.e.b.service.FileDownloaderService  : FileURL: ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR691/006/ERR6912696/ERR6912696_1.fastq.gz
2023-10-12 16:54:22.091 DEBUG 8132 --- [pool-3-thread-1] u.a.e.e.b.service.FileDownloaderService  : Downloading ERR6912696_1.fastq.gz, parentId:SAMEA10254937
2023-10-12 16:55:19.486 DEBUG 8132 --- [pool-3-thread-1] u.a.e.e.b.service.FileDownloaderService  : Completed download ERR6912696_1.fastq.gz, parentId:SAMEA10254937, bytesCopied:4597524
2023-10-12 16:55:19.506 DEBUG 8132 --- [pool-3-thread-1] u.a.e.e.b.service.FileDownloaderService  : MD5 validation successful for file:ftp.sra.ebi.ac.uk/vol1/fastq/ERR691/006/ERR6912696/ERR6912696_1.fastq.gz
2023-10-12 16:55:19.506 DEBUG 8132 --- [pool-3-thread-1] u.a.e.e.b.service.FileDownloaderService  : C:/Users/ns651/OneDrive\reads_fastq\SAMEA10254937\ERR6912696\ERR6912696_1.fastq.gz completed.
2023-10-12 16:55:19.506  INFO 8132 --- [pool-3-thread-1] u.a.e.e.b.service.FileDownloaderService  : FileURL: ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR691/006/ERR6912696/ERR6912696_2.fastq.gz
2023-10-12 16:55:19.507 DEBUG 8132 --- [pool-3-thread-1] u.a.e.e.b.service.FileDownloaderService  : Downloading ERR6912696_2.fastq.gz, parentId:SAMEA10254937
2023-10-12 16:55:44.150 DEBUG 8132 --- [pool-3-thread-1] u.a.e.e.b.service.FileDownloaderService  : Completed download ERR6912696_2.fastq.gz, parentId:SAMEA10254937, bytesCopied:5022873
2023-10-12 16:55:44.161 DEBUG 8132 --- [pool-3-thread-1] u.a.e.e.b.service.FileDownloaderService  : MD5 validation successful for file:ftp.sra.ebi.ac.uk/vol1/fastq/ERR691/006/ERR6912696/ERR6912696_2.fastq.gz
2023-10-12 16:55:44.161 DEBUG 8132 --- [pool-3-thread-1] u.a.e.e.b.service.FileDownloaderService  : C:/Users/ns651/OneDrive\reads_fastq\SAMEA10254937\ERR6912696\ERR6912696_2.fastq.gz completed.
2023-10-12 16:55:44.162  INFO 8132 --- [main] console                                  : 2 files successfully downloaded for accessionField:sample_accession, format:READS_FASTQ to C:/Users/ns651/OneDrive
2023-10-12 16:55:44.297 ERROR 8132 --- [main] u.a.e.e.b.service.EnaPortalService       : Exception encountered while sending email to emailId:NULL

org.springframework.web.client.HttpServerErrorException$InternalServerError: 500 : [Error sending email, Please try again later.]
	at org.springframework.web.client.HttpServerErrorException.create(HttpServerErrorException.java:100)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:188)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:125)
	at org.springframework.web.client.ResponseErrorHandler.handleError(ResponseErrorHandler.java:63)
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:819)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:777)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:751)
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:459)
	at uk.ac.ebi.ena.backend.service.EnaPortalService.sendEmail(EnaPortalService.java:353)
	at uk.ac.ebi.ena.backend.service.EmailService.sendEmailForFastqSubmitted(EmailService.java:84)
	at uk.ac.ebi.ena.backend.service.BackendServiceImpl.startDownload(BackendServiceImpl.java:113)
	at uk.ac.ebi.ena.app.MainRunner.run(MainRunner.java:122)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:819)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:803)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:346)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1340)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1329)
	at uk.ac.ebi.ena.EnaFileDownloaderApplication.main(EnaFileDownloaderApplication.java:30)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:104)
	at java.base/java.lang.reflect.Method.invoke(Method.java:578)
	at org.springframework.boot.loader.MainMethodRunner.run(MainMethodRunner.java:49)
	at org.springframework.boot.loader.Launcher.launch(Launcher.java:108)
	at org.springframework.boot.loader.Launcher.launch(Launcher.java:58)
	at org.springframework.boot.loader.JarLauncher.main(JarLauncher.java:88)

2023-10-12 16:55:44.297  INFO 8132 --- [main] console                                  : Email successfully sent to:NULL
2023-10-12 16:55:44.298  INFO 8132 --- [main] console                                  : Downloads Completed
